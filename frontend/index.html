<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini-CRM</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- React and ReactDOM CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- React Flow CDN -->
    <link rel="stylesheet" href="https://unpkg.com/reactflow/dist/style.css">
    <script src="https://unpkg.com/reactflow@11/dist/umd/index.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f2f5; /* Light gray background for the overall page */
        }
        #root {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        .react-flow__node.default {
            border-radius: 0.5rem;
            padding: 0.75rem 1.25rem;
            font-size: 0.875rem;
            font-weight: 500;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
        }
        .react-flow__node.trigger {
            background-color: #dbeafe; /* blue-100 */
            border-color: #93c5fd; /* blue-300 */
            color: #1e40af; /* blue-800 */
        }
        .react-flow__node.action-email {
            background-color: #dcfce7; /* green-100 */
            border-color: #86efac; /* green-300 */
            color: #166534; /* green-800 */
        }
        .react-flow__node.action-status {
            background-color: #fef9c3; /* yellow-100 */
            border-color: #fde047; /* yellow-300 */
            color: #a16207; /* yellow-800 */
        }
        .react-flow__handle {
            background-color: #3b82f6; /* blue-500 */
            border: 1px solid #2563eb; /* blue-600 */
        }
        /* Custom scrollbar for chat */
        .chat-scroll-area::-webkit-scrollbar {
            width: 8px;
        }
        .chat-scroll-area::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .chat-scroll-area::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        .chat-scroll-area::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback } = React;
        const { createRoot } = ReactDOM;
        const { ReactFlow, MiniMap, Controls, Background, useNodesState, useEdgesState, addEdge } = ReactFlow;
        
        // Inline SVG Icons (replacing lucide-react)
        const Icon = ({ children, size = 24, className = '', ...props }) => (
            <svg
                xmlns="http://www.w3.org/2000/svg"
                width={size}
                height={size}
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                strokeWidth="2"
                strokeLinecap="round"
                strokeLinejoin="round"
                className={className}
                {...props}
            >
                {children}
            </svg>
        );

        const Mail = (props) => <Icon {...props}><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></Icon>;
        const RefreshCw = (props) => <Icon {...props}><path d="M23 4v6h-6"></path><path d="M2 20v-6h6"></path><path d="M21 13a10 10 0 1 1-3.41-7.5l-2.64 2.64"></path><path d="M3 11a10 10 0 1 1 3.41 7.5l2.64-2.64"></path></Icon>;
        const Trash2 = (props) => <Icon {...props}><path d="M3 6h18"></path><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></Icon>;
        const Plus = (props) => <Icon {...props}><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></Icon>;
        const UploadCloud = (props) => <Icon {...props}><polyline points="16 16 12 12 8 16"></polyline><line x1="12" y1="12" x2="12" y2="21"></line><path d="M20.39 18.39A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.3"></path><polyline points="16 16 12 12 8 16"></polyline></Icon>;
        const User = (props) => <Icon {...props}><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></Icon>;
        const MailIcon = (props) => <Icon {...props}><rect x="2" y="4" width="20" height="16" rx="2"></rect><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path></Icon>;
        const Briefcase = (props) => <Icon {...props}><rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path></Icon>;
        const List = (props) => <Icon {...props}><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></Icon>;
        const X = (props) => <Icon {...props}><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></Icon>;
        const Send = (props) => <Icon {...props}><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></Icon>;
        const ChevronDown = (props) => <Icon {...props}><polyline points="6 9 12 15 18 9"></polyline></Icon>;
        const Download = (props) => <Icon {...props}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></Icon>;
        const Bell = (props) => <Icon {...props}><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 0 1-3.46 0"></path></Icon>;
        const Search = (props) => <Icon {...props}><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></Icon>;
        const Calendar = (props) => <Icon {...props}><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></Icon>;
        const DollarSign = (props) => <Icon {...props}><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></Icon>;
        const Users = (props) => <Icon {...props}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M22 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></Icon>;
        const Target = (props) => <Icon {...props}><circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="6"></circle><circle cx="12" cy="12" r="2"></circle></Icon>;
        const TrendingUp = (props) => <Icon {...props}><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"></polyline><polyline points="16 7 22 7 22 13"></polyline></Icon>;
        const TrendingDown = (props) => <Icon {...props}><polyline points="22 17 13.5 8.5 8.5 13.5 2 7"></polyline><polyline points="16 17 22 17 22 11"></polyline></Icon>;
        const PieChart = (props) => <Icon {...props}><path d="M21.21 15.89A10 10 0 1 1 8 2.83"></path><path d="M22 12A10 10 0 0 0 12 2v10z"></path></Icon>;
        const ClipboardList = (props) => <Icon {...props}><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><path d="M15 2H9a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1z"></path><path d="M10 9h4"></path><path d="M10 13h4"></path><path d="M10 17h4"></path></Icon>;


        const API_BASE_URL = "http://127.0.0.1:8000";

        // Custom Modal Component
        const Modal = ({ isOpen, onClose, title, children }) => {
            if (!isOpen) return null;
            return (
                <div className="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-lg shadow-xl w-full max-w-lg mx-auto p-6 relative">
                        <div className="flex justify-between items-center border-b pb-3 mb-4">
                            <h3 className="text-xl font-semibold text-gray-800">{title}</h3>
                            <button onClick={onClose} className="text-gray-500 hover:text-gray-700">
                                <X size={24} />
                            </button>
                        </div>
                        <div className="max-h-[70vh] overflow-y-auto chat-scroll-area">
                            {children}
                        </div>
                    </div>
                </div>
            );
        };

        // Custom Confirmation Modal
        const ConfirmModal = ({ isOpen, onConfirm, onCancel, message }) => {
            if (!isOpen) return null;
            return (
                <div className="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-lg shadow-xl w-full max-w-sm mx-auto p-6">
                        <p className="text-lg text-gray-800 mb-6">{message}</p>
                        <div className="flex justify-end space-x-3">
                            <button
                                onClick={onCancel}
                                className="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors duration-200"
                            >
                                Cancel
                            </button>
                            <button
                                onClick={onConfirm}
                                className="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors duration-200"
                            >
                                Confirm
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        // Header Component
        const Header = ({ currentView, setCurrentView }) => (
            <header className="bg-white p-4 shadow-sm border-b border-gray-200">
                <div className="container mx-auto flex justify-between items-center">
                    <h1 className="text-2xl font-semibold text-gray-800">CRM Dashboard</h1>
                    <div className="flex items-center space-x-6">
                        <div className="relative">
                            <input
                                type="text"
                                placeholder="Search..."
                                className="pl-10 pr-4 py-2 rounded-full border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-200 text-sm"
                            />
                            <Search size={18} className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" />
                        </div>
                        <nav className="space-x-4">
                            <button
                                onClick={() => setCurrentView('dashboard')}
                                className={`px-4 py-2 rounded-md transition-colors duration-200 text-sm font-medium ${
                                    currentView === 'dashboard' ? 'bg-blue-50 text-blue-700' : 'text-gray-600 hover:bg-gray-100'
                                }`}
                            >
                                Dashboard
                            </button>
                            <button
                                onClick={() => setCurrentView('workflow')}
                                className={`px-4 py-2 rounded-md transition-colors duration-200 text-sm font-medium ${
                                    currentView === 'workflow' ? 'bg-blue-50 text-blue-700' : 'text-gray-600 hover:bg-gray-100'
                                }`}
                            >
                                Workflow Designer
                            </button>
                        </nav>
                        <div className="flex items-center space-x-4">
                            <Bell size={20} className="text-gray-600 cursor-pointer hover:text-blue-600" />
                            <Download size={20} className="text-gray-600 cursor-pointer hover:text-blue-600" />
                            <div className="w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center text-sm font-semibold text-gray-700">
                                JD
                            </div>
                        </div>
                    </div>
                </div>
            </header>
        );

        // Notification/Toast Component
        const Toast = ({ message, type, onClose }) => {
            const bgColor = type === 'success' ? 'bg-green-500' : 'bg-red-500';
            return (
                <div className={`fixed bottom-4 right-4 ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg flex items-center space-x-2 z-50 animate-fade-in-up`}>
                    <span>{message}</span>
                    <button onClick={onClose} className="ml-2 text-white opacity-75 hover:opacity-100">
                        <X size={18} />
                    </button>
                </div>
            );
        };

        // Dashboard Component
        const Dashboard = () => {
            const [leads, setLeads] = useState([]);
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState(null);
            const [filterStatus, setFilterStatus] = useState('All');
            const [filterPhone, setFilterPhone] = useState('');
            const [newLead, setNewLead] = useState({ name: '', email: '', phone: '', source: 'Manual' });
            const [isInteractionModalOpen, setIsInteractionModalOpen] = useState(false);
            const [selectedLead, setSelectedLead] = useState(null);
            const [llmQuery, setLlmQuery] = useState('');
            const [llmResponses, setLlmResponses] = useState([]);
            const [isUploading, setIsUploading] = useState(false);
            const [toast, setToast] = useState(null);
            const fileInputRef = useRef(null);
            const [isConfirmModalOpen, setIsConfirmModalOpen] = useState(false);
            const [leadToDelete, setLeadToDelete] = useState(null);

            // New states for dashboard metrics
            const [dashboardMetrics, setDashboardMetrics] = useState({
                targetCompletion: 0,
                totalCustomers: 0,
                totalDeals: 0,
                totalRevenue: 0,
                leadsBySource: [],
                tasks: [],
                salesPipeline: []
            });
            const [metricsLoading, setMetricsLoading] = useState(true);

            const showToast = (message, type = 'success') => {
                setToast({ message, type });
                setTimeout(() => setToast(null), 3000);
            };

            // Simulate fetching dashboard metrics
            const fetchDashboardMetrics = useCallback(() => {
                setMetricsLoading(true);
                // In a real application, you would fetch this data from your backend API
                // For now, we'll simulate it with a delay
                setTimeout(() => {
                    setDashboardMetrics({
                        targetCompletion: 48, // Adjusted to match "48% of the given target"
                        totalCustomers: 1890,
                        totalDeals: 102890,
                        totalRevenue: 435578,
                        leadsBySource: [
                            { name: 'SOCIAL', count: 275, color: '#3B82F6' }, // blue-500
                            { name: 'EMAIL', count: 200, color: '#10B981' },  // green-500
                            { name: 'CALL', count: 287, color: '#F59E0B' },   // yellow-500
                            { name: 'OTHERS', count: 173, color: '#EF4444' }  // red-500
                        ],
                        tasks: [
                            { title: 'Follow up with Acme Inc.', description: 'Send proposal and schedule meeting', priority: 'High', dueDate: 'Today' },
                            { title: 'Prepare quarterly report', description: 'Compile sales data and forecasts', priority: 'Medium', dueDate: 'Tomorrow' },
                            { title: 'Update customer profiles', description: 'Verify contact information and preferences', priority: 'Low', dueDate: 'Oct 15' }
                        ],
                        salesPipeline: [
                            { name: 'Lead', count: 235, amount: 435500, percent: 38 },
                            { name: 'Qualified', count: 146, amount: 267300, percent: 24 },
                            { name: 'Proposal', count: 84, amount: 192400, percent: 18 },
                            { name: 'Negotiation', count: 52, amount: 128600, percent: 12 },
                            { name: 'Closed Won', count: 36, amount: 87200, percent: 8 },
                        ]
                    });
                    setMetricsLoading(false);
                }, 500); // Simulate network delay
            }, []); // Empty dependency array means this function is created once

            const fetchLeads = useCallback(async () => {
                setLoading(true);
                setError(null);
                try {
                    let url = `${API_BASE_URL}/leads`;
                    let queryParams = [];
                    if (filterStatus !== 'All') {
                        queryParams.push(`status_filter=${filterStatus}`);
                    }
                    if (filterPhone.trim() !== '') {
                        queryParams.push(`phone_filter=${encodeURIComponent(filterPhone.trim())}`);
                    }
                    if (queryParams.length > 0) {
                        url += `?${queryParams.join('&')}`;
                    }
                    const response = await fetch(url);
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const data = await response.json();
                    setLeads(data);
                } catch (e) {
                    console.error("Failed to fetch leads:", e);
                    setError("Failed to load leads. Please try again.");
                    showToast("Failed to load leads.", "error");
                } finally {
                    setLoading(false);
                }
            }, [filterStatus, filterPhone]); // Dependencies for fetchLeads


            useEffect(() => {
                fetchLeads();
                fetchDashboardMetrics();
            }, [fetchLeads, fetchDashboardMetrics]); // Now these are stable functions from useCallback


            const handleManualLeadChange = (e) => {
                setNewLead({ ...newLead, [e.target.name]: e.target.value });
            };

            const handleCreateManualLead = async (e) => {
                e.preventDefault();
                setError(null);
                try {
                    const response = await fetch(`${API_BASE_URL}/leads/`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(newLead),
                    });
                    const data = await response.json();
                    if (!response.ok) {
                        const errorMessage = data.detail ? data.detail : JSON.stringify(data);
                        throw new Error(errorMessage || 'Failed to create lead');
                    }
                    showToast("Lead created successfully!");
                    setNewLead({ name: '', email: '', phone: '', source: 'Manual' });
                    fetchLeads();
                } catch (e) {
                    console.error("Error creating lead:", e);
                    setError(e.message);
                    showToast(e.message, "error");
                }
            };

            const handleFileUpload = async (file) => {
                setIsUploading(true);
                setError(null);
                try {
                    const formData = new FormData();
                    formData.append('file', file);

                    const response = await fetch(`${API_BASE_URL}/documents/upload`, {
                        method: 'POST',
                        body: formData,
                    });
                    const data = await response.json();
                    if (!response.ok) {
                        const errorMessage = data.detail ? data.detail : JSON.stringify(data);
                        throw new Error(errorMessage || 'Failed to upload document');
                    }
                    showToast("Document processed and leads uploaded!");
                    fetchLeads();
                } catch (e) {
                    console.error("Error uploading document:", e);
                    setError(e.message);
                    showToast(e.message, "error");
                } finally {
                    setIsUploading(false);
                }
            };

            const handleDragOver = (e) => {
                e.preventDefault();
                e.stopPropagation();
                e.dataTransfer.dropEffect = 'copy';
            };

            const handleDrop = (e) => {
                e.preventDefault();
                e.stopPropagation();
                if (e.dataTransfer.files && e.dataTransfer.files.length > 0) {
                    handleFileUpload(e.dataTransfer.files[0]);
                    e.dataTransfer.clearData();
                }
            };

            const handleFileChange = (e) => {
                if (e.target.files && e.target.files.length > 0) {
                    handleFileUpload(e.target.files[0]);
                }
            };

            const handleDeleteLeadClick = (leadId) => {
                setLeadToDelete(leadId);
                setIsConfirmModalOpen(true);
            };

            const confirmDeleteLead = async () => {
                setIsConfirmModalOpen(false);
                setError(null);
                try {
                    const response = await fetch(`${API_BASE_URL}/leads/${leadToDelete}`, {
                        method: 'DELETE',
                    });
                    if (!response.ok) {
                        throw new Error(`Failed to delete lead: ${response.statusText}`);
                    }
                    showToast("Lead deleted successfully!");
                    fetchLeads();
                } catch (e) {
                    console.error("Error deleting lead:", e);
                    setError(e.message);
                    showToast(e.message, "error");
                } finally {
                    setLeadToDelete(null);
                }
            };

            const cancelDeleteLead = () => {
                setIsConfirmModalOpen(false);
                setLeadToDelete(null);
            };

            const handleUpdateStatus = async (lead, newStatus) => {
                setError(null);
                try {
                    const response = await fetch(`${API_BASE_URL}/leads/${lead.id}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ ...lead, status: newStatus }),
                    });
                    const data = await response.json();
                    if (!response.ok) {
                        const errorMessage = data.detail ? data.detail : JSON.stringify(data);
                        throw new Error(errorMessage || 'Failed to update lead status');
                    }
                    showToast("Lead status updated!");
                    fetchLeads();
                } catch (e) {
                    console.error("Error updating status:", e);
                    setError(e.message);
                    showToast(e.message, "error");
                }
            };

            const openInteractionModal = (lead) => {
                setSelectedLead(lead);
                setLlmResponses([]);
                setLlmQuery('');
                setIsInteractionModalOpen(true);
            };

            const closeInteractionModal = () => {
                setIsInteractionModalOpen(false);
                setSelectedLead(null);
            };

            const handleLlmQuery = async () => {
                if (!llmQuery.trim() || !selectedLead) return;

                const currentQuery = llmQuery;
                setLlmResponses(prev => [...prev, { type: 'user', text: currentQuery }]);
                setLlmQuery('');

                try {
                    const response = await fetch(`${API_BASE_URL}/leads/${selectedLead.id}/interact?query=${encodeURIComponent(currentQuery)}`);
                    const data = await response.json();
                    if (!response.ok) {
                        const errorMessage = data.detail ? data.detail : JSON.stringify(data);
                        throw new Error(errorMessage || 'LLM interaction failed');
                    }
                    setLlmResponses(prev => [...prev, { type: 'llm', text: data.response }]);
                } catch (e) {
                    console.error("LLM interaction error:", e);
                    setLlmResponses(prev => [...prev, { type: 'error', text: `Error: ${e.message}` }]);
                    showToast("LLM interaction failed.", "error");
                }
            };

            const filteredLeads = leads.filter(lead => 
                (filterStatus === 'All' || lead.status === filterStatus) &&
                (filterPhone.trim() === '' || (lead.phone && lead.phone.includes(filterPhone.trim())))
            );

            return (
                <main className="container mx-auto p-6 flex-grow">
                    <div className="flex justify-between items-center mb-6">
                        <h2 className="text-3xl font-bold text-gray-800">CRM Dashboard</h2>
                        <div className="flex items-center text-gray-600 text-sm font-medium space-x-2">
                            <Calendar size={16} />
                            <span>12 Jun 2025 - 09 Jul 2025</span>
                            <button className="ml-4 bg-blue-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-blue-700 transition-colors duration-200 flex items-center">
                                <Download size={16} className="mr-2" /> Download
                            </button>
                        </div>
                    </div>

                    {error && (
                        <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-6" role="alert">
                            <strong className="font-bold">Error!</strong>
                            <span className="block sm:inline"> {error}</span>
                        </div>
                    )}

                    {/* Top Metric Cards */}
                    <section className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                        <div className="bg-white p-6 rounded-lg shadow-sm flex items-center space-x-4">
                            <div className="p-3 bg-blue-100 rounded-full">
                                <Target size={24} className="text-blue-600" />
                            </div>
                            <div>
                                <p className="text-sm text-gray-500">Your target is incomplete</p>
                                {metricsLoading ? (
                                    <div className="h-6 w-24 bg-gray-200 animate-pulse rounded"></div>
                                ) : (
                                    <h4 className="text-xl font-semibold text-gray-800">{dashboardMetrics.targetCompletion}%</h4>
                                )}
                                <p className="text-xs text-gray-500">You have completed {dashboardMetrics.targetCompletion}% of the given target, you can also check your status.</p>
                            </div>
                        </div>

                        <div className="bg-white p-6 rounded-lg shadow-sm flex items-center space-x-4">
                            <div className="p-3 bg-green-100 rounded-full">
                                <Users size={24} className="text-green-600" />
                            </div>
                            <div>
                                <p className="text-sm text-gray-500">Total Customers</p>
                                {metricsLoading ? (
                                    <div className="h-6 w-24 bg-gray-200 animate-pulse rounded"></div>
                                ) : (
                                    <h4 className="text-xl font-semibold text-gray-800">{dashboardMetrics.totalCustomers.toLocaleString()}</h4>
                                )}
                                <p className="text-xs text-green-600 flex items-center">
                                    <TrendingUp size={14} className="mr-1"/> +10.4% <span className="text-gray-500 ml-1">from last month</span>
                                </p>
                            </div>
                        </div>

                        <div className="bg-white p-6 rounded-lg shadow-sm flex items-center space-x-4">
                            <div className="p-3 bg-yellow-100 rounded-full">
                                <DollarSign size={24} className="text-yellow-600" />
                            </div>
                            <div>
                                <p className="text-sm text-gray-500">Total Deals</p>
                                {metricsLoading ? (
                                    <div className="h-6 w-24 bg-gray-200 animate-pulse rounded"></div>
                                ) : (
                                    <h4 className="text-xl font-semibold text-gray-800">{dashboardMetrics.totalDeals.toLocaleString()}</h4>
                                )}
                                <p className="text-xs text-red-600 flex items-center">
                                    <TrendingDown size={14} className="mr-1"/> -0.8% <span className="text-gray-500 ml-1">from last month</span>
                                </p>
                            </div>
                        </div>

                        <div className="bg-white p-6 rounded-lg shadow-sm flex items-center space-x-4">
                            <div className="p-3 bg-purple-100 rounded-full">
                                <DollarSign size={24} className="text-purple-600" />
                            </div>
                            <div>
                                <p className="text-sm text-gray-500">Total Revenue</p>
                                {metricsLoading ? (
                                    <div className="h-6 w-24 bg-gray-200 animate-pulse rounded"></div>
                                ) : (
                                    <h4 className="text-xl font-semibold text-gray-800">${dashboardMetrics.totalRevenue.toLocaleString()}</h4>
                                )}
                                <p className="text-xs text-green-600 flex items-center">
                                    <TrendingUp size={14} className="mr-1"/> +20.1% <span className="text-gray-500 ml-1">from last month</span>
                                </p>
                            </div>
                        </div>
                    </section>

                    {/* Middle Section: Leads by Source, Tasks, Sales Pipeline */}
                    <section className="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                        <div className="bg-white p-6 rounded-lg shadow-sm">
                            <h3 className="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                                <PieChart size={20} className="mr-2 text-gray-600" /> Leads by Source
                            </h3>
                            {metricsLoading ? (
                                <div className="flex items-center justify-center h-48 bg-gray-100 rounded animate-pulse"></div>
                            ) : (
                                <>
                                    <div className="flex items-center justify-center mb-4">
                                        {/* Simplified Donut Chart Representation - dynamic total */}
                                        <div className="relative w-32 h-32 rounded-full bg-gray-200 flex items-center justify-center text-2xl font-bold text-gray-700">
                                            {dashboardMetrics.leadsBySource.reduce((sum, src) => sum + src.count, 0)}
                                            <span className="absolute text-sm font-normal bottom-8">Leads</span>
                                            {/* Dynamic color rings could be complex, keeping static for visual effect */}
                                            <div className="absolute inset-0 rounded-full border-8 border-t-blue-500 border-r-green-500 border-b-yellow-500 border-l-red-500 animate-spin-slow"></div>
                                        </div>
                                    </div>
                                    <div className="grid grid-cols-2 gap-2 text-sm text-gray-700">
                                        {dashboardMetrics.leadsBySource.map((source, index) => (
                                            <div key={index} className="flex items-center">
                                                <span className={`w-3 h-3 rounded-full mr-2`} style={{ backgroundColor: source.color }}></span>
                                                {source.name} <span className="ml-auto font-medium">{source.count}</span>
                                            </div>
                                        ))}
                                    </div>
                                </>
                            )}
                        </div>

                        <div className="bg-white p-6 rounded-lg shadow-sm">
                            <h3 className="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                                <ClipboardList size={20} className="mr-2 text-gray-600" /> Tasks
                            </h3>
                            {metricsLoading ? (
                                <div className="space-y-4">
                                    <div className="h-20 bg-gray-100 rounded animate-pulse"></div>
                                    <div className="h-20 bg-gray-100 rounded animate-pulse"></div>
                                    <div className="h-20 bg-gray-100 rounded animate-pulse"></div>
                                </div>
                            ) : (
                                <div className="space-y-4">
                                    {dashboardMetrics.tasks.map((task, index) => (
                                        <div key={index} className="border border-gray-200 rounded-md p-3">
                                            <p className="text-gray-700 font-medium">{task.title}</p>
                                            <p className="text-sm text-gray-500">{task.description}</p>
                                            <span className={`text-xs font-semibold px-2 py-0.5 rounded-full mt-1 inline-block ${
                                                task.priority === 'High' ? 'text-red-700 bg-red-100' :
                                                task.priority === 'Medium' ? 'text-yellow-700 bg-yellow-100' :
                                                'text-green-700 bg-green-100'
                                            }`}>
                                                {task.priority}
                                            </span>
                                            <span className="text-xs text-gray-500 ml-2">Due {task.dueDate}</span>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>

                        <div className="bg-white p-6 rounded-lg shadow-sm">
                            <h3 className="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                                <Briefcase size={20} className="mr-2 text-gray-600" /> Sales Pipeline
                            </h3>
                            {metricsLoading ? (
                                <div className="space-y-4">
                                    <div className="h-16 bg-gray-100 rounded animate-pulse"></div>
                                    <div className="h-16 bg-gray-100 rounded animate-pulse"></div>
                                    <div className="h-16 bg-gray-100 rounded animate-pulse"></div>
                                </div>
                            ) : (
                                <div className="space-y-4">
                                    {dashboardMetrics.salesPipeline.map((stage, index) => (
                                        <div key={index}>
                                            <div className="flex justify-between text-sm text-gray-700 mb-1">
                                                <span>{stage.name} ({stage.count} deals)</span>
                                                <span>${stage.amount.toLocaleString()}</span>
                                            </div>
                                            <div className="w-full bg-gray-200 rounded-full h-2.5">
                                                <div
                                                    className="bg-blue-500 h-2.5 rounded-full"
                                                    style={{ width: `${stage.percent}%` }}
                                                ></div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                    </section>

                    {/* Lead Creation and Leads Table */}
                    <section className="grid grid-cols-1 xl:grid-cols-3 gap-6 mb-6">
                        <div className="bg-white p-6 rounded-lg shadow-sm xl:col-span-1">
                            <h3 className="text-xl font-semibold text-gray-700 mb-4">Create New Lead</h3>
                            <div className="space-y-6">
                                {/* Manual Lead Entry */}
                                <div>
                                    <h4 className="text-lg font-medium text-gray-600 mb-3 flex items-center"><User size={18} className="mr-2"/>Manual Entry</h4>
                                    <form onSubmit={handleCreateManualLead} className="space-y-4">
                                        <div>
                                            <label htmlFor="name" className="block text-sm font-medium text-gray-700">Name</label>
                                            <input
                                                type="text"
                                                id="name"
                                                name="name"
                                                value={newLead.name}
                                                onChange={handleManualLeadChange}
                                                className="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500"
                                                required
                                            />
                                        </div>
                                        <div>
                                            <label htmlFor="email" className="block text-sm font-medium text-gray-700">Email</label>
                                            <input
                                                type="email"
                                                id="email"
                                                name="email"
                                                value={newLead.email}
                                                onChange={handleManualLeadChange}
                                                className="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500"
                                                required
                                            />
                                        </div>
                                        <div>
                                            <label htmlFor="phone" className="block text-sm font-medium text-gray-700">Phone</label>
                                            <input
                                                type="text"
                                                id="phone"
                                                name="phone"
                                                value={newLead.phone}
                                                onChange={handleManualLeadChange}
                                                className="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500"
                                            />
                                        </div>
                                        <button
                                            type="submit"
                                            className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 flex items-center justify-center"
                                        >
                                            <Plus size={20} className="mr-2"/> Create Lead
                                        </button>
                                    </form>
                                </div>

                                {/* Document Upload */}
                                <div>
                                    <h4 className="text-lg font-medium text-gray-600 mb-3 flex items-center"><UploadCloud size={18} className="mr-2"/>Document Upload</h4>
                                    <div
                                        onDragOver={handleDragOver}
                                        onDrop={handleDrop}
                                        onClick={() => fileInputRef.current.click()}
                                        className="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center cursor-pointer hover:border-blue-400 hover:bg-blue-50 transition duration-200 h-48 flex flex-col items-center justify-center"
                                    >
                                        {isUploading ? (
                                            <div className="flex items-center space-x-2 text-blue-600">
                                                <RefreshCw size={20} className="animate-spin" />
                                                <span>Uploading...</span>
                                            </div>
                                        ) : (
                                            <>
                                                <UploadCloud size={48} className="text-gray-400 mb-3" />
                                                <p className="text-gray-600">Drag & drop a PDF, TXT, or DOCX file here, or click to select</p>
                                            </>
                                        )}
                                        <input
                                            type="file"
                                            ref={fileInputRef}
                                            onChange={handleFileChange}
                                            className="hidden"
                                            accept=".pdf,.txt,.docx"
                                        />
                                    </div>
                                    <p className="text-sm text-gray-500 mt-2">Max file size: 10MB. Extracts name, email, phone.</p>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white p-6 rounded-lg shadow-sm xl:col-span-2">
                            <div className="flex justify-between items-center mb-4">
                                <h3 className="text-xl font-semibold text-gray-700">Leads</h3>
                                <div className="flex items-center space-x-4">
                                    <span className="text-gray-700 text-sm">Filter by Status:</span>
                                    <select
                                        value={filterStatus}
                                        onChange={(e) => setFilterStatus(e.target.value)}
                                        className="border border-gray-300 rounded-md p-2 text-sm focus:ring-blue-500 focus:border-blue-500"
                                    >
                                        <option value="All">All</option>
                                        <option value="New">New</option>
                                        <option value="Contacted">Contacted</option>
                                        <option value="Qualified">Qualified</option>
                                        <option value="Proposal">Proposal</option>
                                        <option value="Negotiation">Negotiation</option>
                                        <option value="Closed Won">Closed Won</option>
                                        <option value="Closed Lost">Closed Lost</option>
                                    </select>
                                    <div className="relative">
                                        <input
                                            type="text"
                                            placeholder="Filter by phone..."
                                            value={filterPhone}
                                            onChange={(e) => setFilterPhone(e.target.value)}
                                            className="border border-gray-300 rounded-md p-2 pl-8 text-sm focus:ring-blue-500 focus:border-blue-500"
                                        />
                                        <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5 text-gray-400 absolute left-2 top-1/2 -translate-y-1/2" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth="2">
                                            <path strokeLinecap="round" strokeLinejoin="round" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                                        </svg>
                                    </div>
                                    <button
                                        onClick={fetchLeads}
                                        className="bg-gray-100 text-gray-700 p-2 rounded-md hover:bg-gray-200 transition duration-200"
                                    >
                                        <RefreshCw size={20} />
                                    </button>
                                    <button className="bg-gray-100 text-gray-700 px-3 py-2 rounded-md hover:bg-gray-200 transition duration-200 text-sm font-medium">
                                        Columns <ChevronDown size={16} className="inline-block ml-1" />
                                    </button>
                                </div>
                            </div>

                            {loading ? (
                                <div className="text-center py-8 text-gray-600">Loading leads...</div>
                            ) : filteredLeads.length === 0 ? (
                                <div className="text-center py-8 text-gray-600">No leads found.</div>
                            ) : (
                                <div className="overflow-x-auto rounded-lg border border-gray-200">
                                    <table className="min-w-full bg-white">
                                        <thead className="bg-gray-50">
                                            <tr>
                                                <th className="py-3 px-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                                    <input type="checkbox" className="rounded text-blue-600 focus:ring-blue-500" />
                                                </th>
                                                <th className="py-3 px-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Status</th>
                                                <th className="py-3 px-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Name</th>
                                                <th className="py-3 px-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Email</th>
                                                <th className="py-3 px-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Phone</th>
                                                <th className="py-3 px-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Source</th>
                                                <th className="py-3 px-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody className="divide-y divide-gray-200">
                                            {filteredLeads.map((lead) => (
                                                <tr key={lead.id} className="hover:bg-gray-50">
                                                    <td className="py-3 px-4">
                                                        <input type="checkbox" className="rounded text-blue-600 focus:ring-blue-500" />
                                                    </td>
                                                    <td className="py-3 px-4">
                                                        <span className={`px-2 py-0.5 rounded-full text-xs font-medium ${
                                                            lead.status === 'New' ? 'bg-blue-100 text-blue-800' :
                                                            lead.status === 'Contacted' ? 'bg-green-100 text-green-800' :
                                                            lead.status === 'Qualified' ? 'bg-purple-100 text-purple-800' :
                                                            lead.status === 'Proposal' ? 'bg-indigo-100 text-indigo-800' :
                                                            lead.status === 'Negotiation' ? 'bg-orange-100 text-orange-800' :
                                                            lead.status === 'Closed Won' ? 'bg-emerald-100 text-emerald-800' :
                                                            'bg-red-100 text-red-800'
                                                        }`}>
                                                            {lead.status}
                                                        </span>
                                                    </td>
                                                    <td className="py-3 px-4 text-sm text-gray-800">{lead.name}</td>
                                                    <td className="py-3 px-4 text-sm text-gray-800">{lead.email}</td>
                                                    <td className="py-3 px-4 text-sm text-gray-800">{lead.phone || 'N/A'}</td>
                                                    <td className="py-3 px-4 text-sm text-gray-800">{lead.source}</td>
                                                    <td className="py-3 px-4 flex items-center space-x-2">
                                                        <button
                                                            onClick={() => openInteractionModal(lead)}
                                                            className="text-blue-600 hover:text-blue-800 transition duration-200 text-sm flex items-center"
                                                        >
                                                            <Mail size={16} className="mr-1"/> Interact
                                                        </button>
                                                        <div className="relative group">
                                                            <button
                                                                className="text-yellow-600 hover:text-yellow-800 transition duration-200 text-sm flex items-center"
                                                            >
                                                                <Briefcase size={16} className="mr-1"/> Status <ChevronDown size={16} className="ml-1"/>
                                                            </button>
                                                            <div className="absolute left-0 mt-1 w-36 bg-white border border-gray-200 rounded-md shadow-lg hidden group-hover:block z-10">
                                                                {['New', 'Contacted', 'Qualified', 'Proposal', 'Negotiation', 'Closed Won', 'Closed Lost'].map(statusOption => (
                                                                    <button
                                                                        key={statusOption}
                                                                        onClick={() => handleUpdateStatus(lead, statusOption)}
                                                                        className="block w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm"
                                                                    >
                                                                        {statusOption}
                                                                    </button>
                                                                ))}
                                                            </div>
                                                        </div>
                                                        <button
                                                            onClick={() => handleDeleteLeadClick(lead.id)}
                                                            className="text-red-600 hover:text-red-800 transition duration-200 text-sm flex items-center"
                                                        >
                                                            <Trash2 size={16} className="mr-1"/> Delete
                                                        </button>
                                                    </td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            )}
                            <div className="text-sm text-gray-600 mt-4">
                                0 of {filteredLeads.length} row(s) selected.
                            </div>
                        </div>
                    </section>

                    {/* Lead Interaction Modal */}
                    <Modal isOpen={isInteractionModalOpen} onClose={closeInteractionModal} title={`Interact with ${selectedLead?.name || 'Lead'}`}>
                        {selectedLead && (
                            <div className="space-y-4">
                                <div className="bg-gray-50 p-4 rounded-md">
                                    <p className="text-gray-700 font-medium">Lead Details:</p>
                                    <p className="text-gray-600 text-sm"><strong>Name:</strong> {selectedLead.name}</p>
                                    <p className="text-gray-600 text-sm"><strong>Email:</strong> {selectedLead.email}</p>
                                    <p className="text-gray-600 text-sm"><strong>Phone:</strong> {selectedLead.phone || 'N/A'}</p>
                                    <p className="text-gray-600 text-sm"><strong>Status:</strong> {selectedLead.status}</p>
                                    <p className="text-gray-600 text-sm"><strong>Source:</strong> {selectedLead.source}</p>
                                </div>
                                <div className="h-64 overflow-y-auto border border-gray-200 rounded-md p-3 bg-gray-50 flex flex-col space-y-2 chat-scroll-area">
                                    {llmResponses.length === 0 && (
                                        <p className="text-gray-500 text-center mt-auto text-sm">Ask the AI about this lead. Try "Suggest follow-up" or "Lead details".</p>
                                    )}
                                    {llmResponses.map((res, index) => (
                                        <div key={index} className={`p-2 rounded-lg max-w-[80%] text-sm ${
                                            res.type === 'user' ? 'bg-blue-100 self-end text-right' : 'bg-gray-200 self-start text-left'
                                        }`}>
                                            <p className="text-gray-800">{res.text}</p>
                                        </div>
                                    ))}
                                </div>
                                <div className="flex space-x-2">
                                    <input
                                        type="text"
                                        value={llmQuery}
                                        onChange={(e) => setLlmQuery(e.target.value)}
                                        onKeyPress={(e) => { if (e.key === 'Enter') handleLlmQuery(); }}
                                        placeholder="Type your query..."
                                        className="flex-grow border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500 text-sm"
                                    />
                                    <button
                                        onClick={handleLlmQuery}
                                        className="bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 flex items-center text-sm"
                                    >
                                        <Send size={18} className="mr-1"/> Send
                                    </button>
                                </div>
                            </div>
                        )}
                    </Modal>
                    {toast && <Toast message={toast.message} type={toast.type} onClose={() => setToast(null)} />}
                    <ConfirmModal
                        isOpen={isConfirmModalOpen}
                        onConfirm={confirmDeleteLead}
                        onCancel={cancelDeleteLead}
                        message="Are you sure you want to delete this lead?"
                    />
                </main>
            );
        };

        // Workflow Designer Component
        const WorkflowDesigner = () => {
            const initialNodes = [
                {
                    id: '1',
                    type: 'default',
                    data: { label: 'Trigger: Lead Created' },
                    position: { x: 250, y: 50 },
                    className: 'trigger',
                    sourcePosition: 'bottom',
                },
            ];

            const initialEdges = [];

            const [nodes, setNodes, onNodesChange] = useNodesState(initialNodes);
            const [edges, setEdges, onEdgesChange] = useEdgesState(initialEdges);
            const [nodeCounter, setNodeCounter] = useState(2);
            const reactFlowWrapper = useRef(null);
            const [reactFlowInstance, setReactFlowInstance] = useState(null);
            const [toast, setToast] = useState(null);

            const showToast = (message, type = 'success') => {
                setToast({ message, type });
                setTimeout(() => setToast(null), 3000);
            };

            const onConnect = useCallback((params) => setEdges((eds) => addEdge(params, eds)), [setEdges]);

            const addActionNode = (type) => {
                const newNode = {
                    id: String(nodeCounter),
                    type: 'default',
                    data: { label: type === 'email' ? 'Action: Send Email' : 'Action: Update Status' },
                    position: {
                        x: nodes[nodes.length - 1].position.x,
                        y: nodes[nodes.length - 1].position.y + 150
                    },
                    className: type === 'email' ? 'action-email' : 'action-status',
                    targetPosition: 'top',
                    sourcePosition: 'bottom',
                };
                setNodes((nds) => nds.concat(newNode));
                setNodeCounter((prev) => prev + 1);
            };

            const onSaveWorkflow = useCallback(() => {
                if (reactFlowInstance) {
                    const flow = reactFlowInstance.toObject();
                    console.log('Saved Workflow:', flow);
                    // In a real app, you'd send this `flow` object to your backend to save the workflow configuration
                    showToast("Workflow saved to console!");
                }
            }, [reactFlowInstance]);

            return (
                <main className="container mx-auto p-6 flex-grow">
                    <h2 className="text-3xl font-bold text-gray-800 mb-6">Workflow Designer</h2>
                    <div className="flex space-x-4 mb-6">
                        <button
                            onClick={() => addActionNode('email')}
                            className="bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition duration-200 flex items-center"
                        >
                            <MailIcon size={20} className="mr-2"/> Add Send Email Action
                        </button>
                        <button
                            onClick={() => addActionNode('status')}
                            className="bg-yellow-600 text-white py-2 px-4 rounded-md hover:bg-yellow-700 transition duration-200 flex items-center"
                        >
                            <Briefcase size={20} className="mr-2"/> Add Update Status Action
                        </button>
                        <button
                            onClick={onSaveWorkflow}
                            className="bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200 flex items-center"
                        >
                            <List size={20} className="mr-2"/> Save Workflow
                        </button>
                    </div>
                    <div className="h-[600px] bg-white rounded-lg shadow-md border border-gray-200" ref={reactFlowWrapper}>
                        <ReactFlow
                            nodes={nodes}
                            edges={edges}
                            onNodesChange={onNodesChange}
                            onEdgesChange={onEdgesChange}
                            onConnect={onConnect}
                            onInit={setReactFlowInstance}
                            fitView
                        >
                            <MiniMap />
                            <Controls />
                            <Background variant="dots" gap={12} size={1} />
                        </ReactFlow>
                    </div>
                    {toast && <Toast message={toast.message} type={toast.type} onClose={() => setToast(null)} />}
                </main>
            );
        };

        // Main App Component
        const App = () => {
            const [currentView, setCurrentView] = useState('dashboard'); // 'dashboard' or 'workflow'

            return (
                <>
                    <Header currentView={currentView} setCurrentView={setCurrentView} />
                    {currentView === 'dashboard' ? <Dashboard /> : <WorkflowDesigner />}
                </>
            );
        };

        // Render the App
        const container = document.getElementById('root');
        const root = createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>
